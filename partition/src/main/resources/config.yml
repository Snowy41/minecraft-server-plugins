# Partition Plugin Configuration
# FIXED: Build server acts as lobby (no separate lobby partition)

isolation:
  chat: true
  tablist: true
  commands: false
  world-border: true

partitions:
  # ===== BUILD SERVER (ALSO LOBBY) =====
  build:
    name: "Build Server"
    description: "Main building environment - also serves as lobby"
    enabled: true

    worlds:
      - "world"
      - "world_nether"
      - "world_the_end"

    plugins:
      - "CorePlugin"           # Infrastructure - won't be reloaded
      - "PartitionPlugin"      # Infrastructure - won't be reloaded
      - "LobbyPlugin"          # Will be reloaded on restart
      - "FastAsyncWorldEdit"   # Will be reloaded on restart
      - "fastasyncvoxelsniper" # Will be reloaded on restart

    spawn-world: "world"
    spawn-location:
      x: -174.5
      y: -45.0
      z: -13.5
      yaw: 0.0
      pitch: 0.0

    auto-load: true
    persistent: true

  # ===== DEV SERVER =====
  dev:
    name: "Dev Server"
    description: "Testing environment for plugin updates"
    enabled: true

    worlds:
      - "dev_world"
      - "dev_world_nether"
      - "dev_world_the_end"

    plugins:
      - "CorePlugin"        # Infrastructure - won't be reloaded
      - "PartitionPlugin"   # Infrastructure - won't be reloaded
      - "LobbyPlugin"       # Will be reloaded on restart
      # Add test plugins here - they'll be hot-reloaded!
      # Example: - "YourTestPlugin"

    spawn-world: "dev_world"
    spawn-location:
      x: 0.5
      y: 64.0
      z: 0.5
      yaw: 0.0
      pitch: 0.0

    auto-load: true
    persistent: true

# Now when you restart dev:
# - Players in "dev_world" → Moved to "build" (world)
# - Players in "world" → Stay in "build" (not moved!)
# - No confusion about which partition "world" belongs to

# ===== HOT-RELOAD BEHAVIOR =====
# When you run /partition restart dev:
#
# WILL BE RELOADED (safe):
# - LobbyPlugin
# - FastAsyncWorldEdit
# - Any custom plugins you add
#
# WON'T BE RELOADED (infrastructure):
# - CorePlugin (database/Redis - critical stability)
# - PartitionPlugin (manages partitions - reloading causes cascade)
#
# This prevents the cascading shutdown issue you experienced!